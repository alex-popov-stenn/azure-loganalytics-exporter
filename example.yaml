queries:
  #########################################################
  ## rows metric for tables (per second)
  - metric: azure_metrics_loganalytics_ingestion_overall_rows
    query: |-
      union withsource=sourceTable *
      | project sourceTable
      | summarize count_ = count() by sourceTable
      | project sourceTable, count_ = (todouble(count_) / 3600)
    timespan: PT1H
    fields:
      -
        name: sourceTable
        type: id
      -
        name: count_
        type: value
    defaultField:
      type: ignore

  #########################################################
  ## bytes metric for tables (per second)
  - metric: azure_metrics_loganalytics_ingestion_overall_bytes
    query: |-
      union withsource=sourceTable *
      | where _IsBillable == true
      | summarize count_ = sum(_BilledSize) by sourceTable
      | project sourceTable, count_ = (todouble(count_) / 3600)
    timespan: PT1H
    fields:
      -
        name: sourceTable
        type: id
      -
        name: count_
        type: value
    defaultField:
      type: ignore
